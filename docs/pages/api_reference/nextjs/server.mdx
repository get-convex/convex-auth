# nextjs/server

## ConvexAuthNextjsServerProvider()


Wrap your app with this provider in your root `layout.tsx`.

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Parameters</h3>

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `__namedParameters` | `object` | - |
| `__namedParameters.apiRoute`? | `string` | You can customize the route path that handles authentication actions via this prop and the `apiRoute` option to `convexAuthNextjsMiddleWare`. Defaults to `/api/auth`. |
| `__namedParameters.storage`? | `"localStorage"` \| `"inMemory"` | Choose how the auth information will be stored on the client. Defaults to `"localStorage"`. If you choose `"inMemory"`, different browser tabs will not have a synchronized authentication state. |
| `__namedParameters.storageNamespace`? | `string` | Optional namespace for keys used to store tokens. The keys determine whether the tokens are shared or not. Any non-alphanumeric characters will be ignored. Defaults to `process.env.NEXT_PUBLIC_CONVEX_URL`. |
| `__namedParameters.verbose`? | `boolean` | Turn on debugging logs. |
| `__namedParameters.children` | `ReactNode` | Children components can call Convex hooks and useAuthActions. |

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Returns</h3>

`Element`

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Defined in</h3>

[src/nextjs/server/index.tsx:22](https://github.com/get-convex/convex-auth/blob/main/src/nextjs/server/index.tsx#L22)

***

## convexAuthNextjsToken()


<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Returns</h3>

`undefined` \| `string`

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Defined in</h3>

[src/nextjs/server/index.tsx:77](https://github.com/get-convex/convex-auth/blob/main/src/nextjs/server/index.tsx#L77)

***

## isAuthenticatedNextjs()


<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Returns</h3>

`boolean`

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Defined in</h3>

[src/nextjs/server/index.tsx:81](https://github.com/get-convex/convex-auth/blob/main/src/nextjs/server/index.tsx#L81)

***

## AuthenticatedNextjs()


<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Parameters</h3>

| Parameter | Type |
| ------ | ------ |
| `__namedParameters` | `object` |
| `__namedParameters.children` | `ReactNode` |

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Returns</h3>

`null` \| `Element`

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Defined in</h3>

[src/nextjs/server/index.tsx:85](https://github.com/get-convex/convex-auth/blob/main/src/nextjs/server/index.tsx#L85)

***

## UnauthenticatedNextjs()


<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Parameters</h3>

| Parameter | Type |
| ------ | ------ |
| `__namedParameters` | `object` |
| `__namedParameters.children` | `ReactNode` |

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Returns</h3>

`null` \| `Element`

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Defined in</h3>

[src/nextjs/server/index.tsx:89](https://github.com/get-convex/convex-auth/blob/main/src/nextjs/server/index.tsx#L89)

***

## convexAuthNextjsMiddleware()


<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Parameters</h3>

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `handler`? | (`request`, `event`) => `NextMiddlewareResult` \| `Promise`\<`NextMiddlewareResult`\> | - |
| `options`? | `object` | - |
| `options.convexUrl`? | `string` | The URL of the Convex deployment to use for authentication. Defaults to `process.env.NEXT_PUBLIC_CONVEX_URL`. |
| `options.apiRoute`? | `string` | You can customize the route path that handles authentication actions via this option and the `apiRoute` prop of `ConvexAuthNextjsProvider`. Defaults to `/api/auth`. |

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Returns</h3>

`NextMiddleware`

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Defined in</h3>

[src/nextjs/server/index.tsx:93](https://github.com/get-convex/convex-auth/blob/main/src/nextjs/server/index.tsx#L93)

***

## nextjsMiddlewareRedirect()


Helper for redirecting to a different route from
a Next.js middleware.

```ts
return nextjsMiddlewareRedirect(request, "/login");
```

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Parameters</h3>

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `request` | `NextRequest` | The incoming request handled by the middleware. |
| `pathname` | `string` | The route path to redirect to. |

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Returns</h3>

`NextResponse`\<`unknown`\>

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Defined in</h3>

[src/nextjs/server/index.tsx:159](https://github.com/get-convex/convex-auth/blob/main/src/nextjs/server/index.tsx#L159)

***

## RouteMatcherParam


See [createRouteMatcher](server.mdx#createroutematcher) for more information.

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Defined in</h3>

[src/nextjs/server/routeMatcher.ts:44](https://github.com/get-convex/convex-auth/blob/main/src/nextjs/server/routeMatcher.ts#L44)

***

## createRouteMatcher()


Returns a function that accepts a `Request` object and returns whether the request matches the list of
predefined routes that can be passed in as the first argument.

You can use glob patterns to match multiple routes or a function to match against the request object.
Path patterns and regular expressions are supported, for example: `['/foo', '/bar(.*)'] or `[/^/foo/.*$/]`
For more information, see: https://github.com/pillarjs/path-to-regexp

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Parameters</h3>

| Parameter | Type |
| ------ | ------ |
| `routes` | [`RouteMatcherParam`](server.mdx#routematcherparam) |

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Returns</h3>

`Function`

<h4 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-lg">Parameters</h4>

| Parameter | Type |
| ------ | ------ |
| `req` | `NextRequest` |

<h4 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-lg">Returns</h4>

`boolean`

<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Defined in</h3>

[src/nextjs/server/routeMatcher.ts:58](https://github.com/get-convex/convex-auth/blob/main/src/nextjs/server/routeMatcher.ts#L58)
